<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>jULIANT: algebraicBootstrapperExample.cpp</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="juliant.css" rel="stylesheet" type="text/css"/>
<link href="bootstrap_custom.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">jULIANT 0.99</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">algebraicBootstrapperExample.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>This example show how to build curve using Algebraic bootstrapper. Programme uses data files stored as csv in ./data directory </p><pre class="fragment">
Name: df_instruments

Object: DataFrame
Size: 9 col 25 rows
--------------------------------------------------------------------------------------------------------
      Type      Rate   FRAstart   Tenor          YF1      YF2   RateConvention    FreqFix        FreqFlo
--------------------------------------------------------------------------------------------------------
   Deposit    0.0487          .      ON       ACT365        .           simple          .              .
   Deposit    0.0487          .      TN       ACT365        .           simple          .              .
   Deposit    0.0483          .      1W       ACT365        .           simple          .              .
   Deposit    0.0485          .      2W       ACT365        .           simple          .              .
   Deposit    0.0491          .      1M       ACT365        .           simple          .              .
   Deposit    0.0494          .      2M       ACT365        .           simple          .              .
   Deposit    0.0513          .      3M       ACT365        .           simple          .              .
   Deposit    0.0514          .      6M       ACT365        .           simple          .              .
       FRA   0.05115         1M      7M       ACT365        .           simple          .              .
       FRA   0.05105         2M      8M       ACT365        .           simple          .              .
       FRA    0.0508         3M      9M       ACT365        .           simple          .              .
       FRA   0.04865         6M     12M       ACT365        .           simple          .              .
       FRA   0.04415        12M     18M       ACT365        .           simple          .              .
       IRS   0.04734          .      2Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04659          .      3Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04662          .      4Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04678          .      5Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04699          .      6Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04722          .      7Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04744          .      8Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04761          .      9Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04765          .     10Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04717          .     12Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04550          .     15Y   ActActISDA   ACT365           simple   annually   semiannually
       IRS   0.04262          .     20Y   ActActISDA   ACT365           simple   annually   semiannually
--------------------------------------------------------------------------------------------------------


Name: df_settings

Object: DataFrame
Size: 11 col 7 rows
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
      Id   Interpolation   InterpolationInput   Compounding       YF   Estimator   SmoothingParam   Iterations   SmoothingInput   FirstDerivative   SecondDerivative
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
   Set22          linear                  ZCR        simple   ACT365   algebraic                .            .                .                 .                  .
   Set23    cubic_spline                  ZCR        simple   ACT365   algebraic                .            .                .                 .                  .
   Set24           AKIMA                  ZCR        simple   ACT365   algebraic                .            .                .                 .                  .
   Set25         Steffen                  ZCR        simple   ACT365   algebraic                .            .                .                 .                  .
   Set26          linear                   DF        simple   ACT365   algebraic                .            .                .                 .                  .
   Set27          linear                invDF        simple   ACT365   algebraic                .            .                .                 .                  .
   Set28          linear                logDF        simple   ACT365   algebraic                .            .                .                 .                  .
--------------------------------------------------------------------------------------------------------------------------------------------------------------------





**********************************
ProgrammeRunTime:1s451ms
**********************************

</pre><p>Plots below presents the interest rate curves build using different interpolation type </p><div class="image">
<img src="algebraic_curves_interpolation.png" alt="algebraic_curves_interpolation.png"/>
</div>
<p> Plots below presents the interest rate curves build using different interpolation inputs </p><div class="image">
<img src="algebraic_curves_inputs.png" alt="algebraic_curves_inputs.png"/>
</div>
<p> Here we present the calibration of the curve. We see perfect match between market quotings and curve implied par rates. </p><div class="image">
<img src="algebraic_curves_calibration.png" alt="algebraic_curves_calibration.png"/>
</div>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;juliant.hpp&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;factoryInit.hpp&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;set&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="a00547.html">julian</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div><div class="line">  <a name="_a0"></a><a class="code" href="a00173.html">RunTimeMeasurment</a> timer;</div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// Setting the calendar and the today date</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <a name="_a1"></a><a class="code" href="a00086.html">Date</a> today(2018, JUN, 20);</div><div class="line">  <a name="_a2"></a><a class="code" href="a00160.html">PLNHoliday</a> holiday;</div><div class="line">  <a name="_a3"></a><a class="code" href="a00067.html">Calendar</a> calendar = <a name="_a4"></a><a class="code" href="a00060.html">BuildCalendar</a>()</div><div class="line">    .<a name="a5"></a><a class="code" href="a00060.html#a4fb5f9261733b7fc67dae9f672d3f2fc">withConvention</a>(<a name="a6"></a><a class="code" href="a00553.html#gga72c0b54263de2f950ea54a37fd65231eafe21cc5d2aa71db6beed567b4643e2dd">MODIFIEDFOLLOWING</a>)</div><div class="line">    .<a name="a7"></a><a class="code" href="a00060.html#a969d54b7c8c50b96e4f9d1eb6be36f23">addHoliday</a>(holiday)</div><div class="line">    .<a name="a8"></a><a class="code" href="a00060.html#a3870d17f443592a3cdea4367c8ba32e4">withSpotLag</a>(2);</div><div class="line"></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// Reading the command line arguments; If not provided, program uses default names</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="keyword">auto</span> args =  <a name="a9"></a><a class="code" href="a00582.html#gabc4c9d00f579cfad6f0988fd436fa226">catchDataAndSettingFileNames</a>(argc, argv);</div><div class="line">  <span class="keyword">auto</span> data_file     = args.first.empty() ? <span class="stringliteral">&quot;../data/curve_data.csv&quot;</span> : args.first;</div><div class="line">  <span class="keyword">auto</span> settings_file = args.second.empty() ? <span class="stringliteral">&quot;../data/curve_settings.csv&quot;</span> : args.second;</div><div class="line">    </div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// Creating benchmark instruments</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <a name="_a10"></a><a class="code" href="a00085.html">DataFrame</a> df_instruments(data_file, <span class="charliteral">&#39;;&#39;</span>, <span class="keyword">true</span>);</div><div class="line">  <span class="keyword">auto</span> df_depo = df_instruments.<a name="a11"></a><a class="code" href="a00085.html#a2871ab3642b43f91d45fd1f0ed382cf2">filter</a>(<span class="stringliteral">&quot;Type&quot;</span>,   [](std::string x)-&gt;<span class="keywordtype">bool</span>{<span class="keywordflow">return</span> x == <span class="stringliteral">&quot;Deposit&quot;</span>;} );</div><div class="line">  <span class="keyword">auto</span> df_fra  = df_instruments.<a class="code" href="a00085.html#a2871ab3642b43f91d45fd1f0ed382cf2">filter</a>(<span class="stringliteral">&quot;Type&quot;</span>,   [](std::string x)-&gt;<span class="keywordtype">bool</span>{<span class="keywordflow">return</span> x == <span class="stringliteral">&quot;FRA&quot;</span>;} );</div><div class="line">  <span class="keyword">auto</span> df_irs  = df_instruments.<a class="code" href="a00085.html#a2871ab3642b43f91d45fd1f0ed382cf2">filter</a>(<span class="stringliteral">&quot;Type&quot;</span>,   [](std::string x)-&gt;<span class="keywordtype">bool</span>{<span class="keywordflow">return</span> x == <span class="stringliteral">&quot;IRS&quot;</span>;} );</div><div class="line"></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// Printing instruments set</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <a name="a12"></a><a class="code" href="a00541.html#a9fd2ed33a3396935b89bfd8b1533e61d">SHOW</a>(df_instruments);</div><div class="line">  std::vector&lt;Deposit&gt; deposits = <a name="a13"></a><a class="code" href="a00562.html#ga72ebb37fb4653f54c0738d714d5d7fbe">ir::readDeposit</a>(df_depo, today, calendar);</div><div class="line">  std::vector&lt;FRA&gt; fras     = <a name="a14"></a><a class="code" href="a00562.html#gae0bbf2a7d1f2adf6ee32f0aaa93960a5">ir::readFRA</a>(df_fra, today, calendar);</div><div class="line">  std::vector&lt;IRS&gt; swaps    = <a name="a15"></a><a class="code" href="a00562.html#ga7396b842b05c3fe7557012e04748cf17">ir::readIRS</a>(df_irs, today, calendar);</div><div class="line"></div><div class="line">  std::vector&lt;SmartPointer&lt;ir::BuildingBlock&gt; &gt; instruments;</div><div class="line">  instruments.insert(instruments.end(), deposits.begin(), deposits.end());</div><div class="line">  instruments.insert(instruments.end(), fras.begin(), fras.end());</div><div class="line">  instruments.insert(instruments.end(), swaps.begin(), swaps.end());</div><div class="line"></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// Reading data settings</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <a class="code" href="a00085.html">DataFrame</a> df_settings(settings_file, <span class="charliteral">&#39;;&#39;</span>, <span class="keyword">true</span>);</div><div class="line">  df_settings = df_settings.<a class="code" href="a00085.html#a2871ab3642b43f91d45fd1f0ed382cf2">filter</a>(<span class="stringliteral">&quot;Estimator&quot;</span>, [](std::string x)-&gt;<span class="keywordtype">bool</span>{<span class="keywordflow">return</span> x == <span class="stringliteral">&quot;algebraic&quot;</span>;} );</div><div class="line"></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// Printing curves&#39; settings</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <a class="code" href="a00541.html#a9fd2ed33a3396935b89bfd8b1533e61d">SHOW</a>(df_settings);</div><div class="line"></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">// Constructing the curve</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <a class="code" href="a00085.html">DataFrame</a> estimation_resuts;</div><div class="line">  <a class="code" href="a00085.html">DataFrame</a> calibration_results;</div><div class="line">  </div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r &lt;=df_settings.<a name="a16"></a><a class="code" href="a00085.html#a6ccc355c2901dfc0b439e16681b6d810">getNumberOfRows</a>(); r++) {</div><div class="line">    <span class="keyword">auto</span> set_name = df_settings(<span class="stringliteral">&quot;Id&quot;</span>, r);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> interpolation = df_settings.<a name="a17"></a><a class="code" href="a00085.html#aad09c3a3ceee8ed84fa7908628b0a428">getObject</a>&lt;<a name="_a18"></a><a class="code" href="a00134.html">Interpolation</a>&gt;(<span class="stringliteral">&quot;Interpolation&quot;</span>, r);</div><div class="line">    <span class="keyword">auto</span> inputs        = df_settings.<a class="code" href="a00085.html#aad09c3a3ceee8ed84fa7908628b0a428">getObject</a>&lt;<a name="_a19"></a><a class="code" href="a00135.html">ir::InterpolationInput</a>&gt;(<span class="stringliteral">&quot;InterpolationInput&quot;</span>, r);</div><div class="line">    <span class="keyword">auto</span> compounding   = df_settings.<a class="code" href="a00085.html#aad09c3a3ceee8ed84fa7908628b0a428">getObject</a>&lt;<a name="_a20"></a><a class="code" href="a00075.html">Compounding</a>&gt;(<span class="stringliteral">&quot;Compounding&quot;</span>, r);</div><div class="line">    <span class="keyword">auto</span> yf            = df_settings.<a class="code" href="a00085.html#aad09c3a3ceee8ed84fa7908628b0a428">getObject</a>&lt;<a name="_a21"></a><a class="code" href="a00201.html">YearFraction</a>&gt;(<span class="stringliteral">&quot;YF&quot;</span>, r);</div><div class="line"></div><div class="line">    <a name="_a22"></a><a class="code" href="a00128.html">InterestRate</a> rate(compounding, yf);</div><div class="line">    <a name="_a23"></a><a class="code" href="a00073.html">ir::CompoundedInterpolator</a> interpolator(interpolation, inputs);</div><div class="line">    <a name="_a24"></a><a class="code" href="a00053.html">ir::AlgebraicBootstrapper</a> estimator;</div><div class="line"></div><div class="line">    <a name="_a25"></a><a class="code" href="a00129.html">ir::InterpolatedCurve</a> curve = <a name="_a26"></a><a class="code" href="a00061.html">ir::BuildCurve</a>()</div><div class="line">      .<a name="a27"></a><a class="code" href="a00061.html#ad0ec805c213cbd30e5b4cc226db98dbf">asOfDate</a>(today)</div><div class="line">      .<a name="a28"></a><a class="code" href="a00061.html#a2f0afc2937cb4e0134a7a37151c9077b">withCalendar</a>(calendar)</div><div class="line">      .<a name="a29"></a><a class="code" href="a00061.html#a4fd907996d320c84da36184c737fb5cd">withInterestRate</a>(rate)</div><div class="line">      .<a name="a30"></a><a class="code" href="a00061.html#ad6eee2aeeba46da623221cf0b556039b">withInterpolator</a>(interpolator)</div><div class="line">      .<a name="a31"></a><a class="code" href="a00061.html#accbd6410ca988daa9454cc47b40f8937">withSetOfInstruments</a>(instruments)</div><div class="line">      .<a name="a32"></a><a class="code" href="a00061.html#af9a3dc235ede5de0c60c69080104bdcb">usingEstimator</a>(estimator);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> calib      = <a name="a33"></a><a class="code" href="a00562.html#gab845dcaccbb431050646db80b0f5416c">ir::getCalibration</a>(curve, instruments, set_name);</div><div class="line">    <span class="keyword">auto</span> curve_data = <a name="a34"></a><a class="code" href="a00562.html#ga9886b53f957367b844cf8d2945cd2e81">ir::getCurves</a>(curve, 1*WEEK, 15*YEAR, set_name);</div><div class="line">    calibration_results.<a name="a35"></a><a class="code" href="a00085.html#a111ba1185edb0132b4f5dde2de381a6a">append</a>(calib);</div><div class="line">    estimation_resuts.<a class="code" href="a00085.html#a111ba1185edb0132b4f5dde2de381a6a">append</a>(curve_data);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">//  Saving results</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  calibration_results.<a name="a36"></a><a class="code" href="a00085.html#a7aba4fc49048a34c5d5a8a89851b7987">printToCsv</a>(<span class="stringliteral">&quot;algebraic_bootstrapper_calibration&quot;</span>);</div><div class="line">  estimation_resuts.<a class="code" href="a00085.html#a7aba4fc49048a34c5d5a8a89851b7987">printToCsv</a>(<span class="stringliteral">&quot;algebraic_bootstrapper_results&quot;</span>);</div><div class="line"></div><div class="line">}</div><div class="line"></div></div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 5 2018 21:15:36 for jULIANT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
